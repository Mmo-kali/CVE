# Advisory: Stored XSS via File Upload in Reimbursement Panel

**Date:** Aug 13, 2025  
**Severity:** High

### Affected versions
< 1.4.0  

### Patched versions
1.4.0

[Full Technical Write-Up (PDF)](https://github.com/Mmo-kali/CVE/blob/main/CVE-2025-59524/2025-08-Horilla_Vulnerability_3.pdf)
---

## Acknowledgements

| Researcher | Profiles / Contact |
|------------|--------------------|
| **Michael Nolk** | [GitHub](https://github.com/Mmo-kali) · [LinkedIn](https://www.linkedin.com/in/michaelnolk/) · [Email](mailto:michaelnolk.kali@gmail.com) |
| **Orlando Companioni** | [GitHub](https://github.com/OrlandoCompC) · [LinkedIn](https://www.linkedin.com/in/orlando-companioni/) · [Email](mailto:companioniorlando@gmail.com) |
| **Micah Rahardjo** | [GitHub](https://github.com/Gikyon) · [LinkedIn](https://www.linkedin.com/in/micahrahardjo/) · [Email](mailto:micahrahardjo@gmail.com) |

---

## Summary
The reimbursement panel’s file upload relies on **client-side-only controls**, allowing an attacker to upload a malicious **HTML** file. If a high-privilege user views that file, attacker-controlled JavaScript executes in the administrator’s browser and exfiltrates session information, enabling admin session hijacking.

---

## Description
The file upload flow performs validation only in the browser and does not enforce server-side checks. An attacker can bypass the client-side validation (for example, with an intercepting proxy or by submitting a crafted request) to store an executable HTML document on the server. When an administrator or other privileged user views the uploaded file, the embedded script runs in their context and sends session cookies (or other credentials) to an attacker-controlled endpoint. The attacker then reuses those credentials to impersonate the admin.

---

### Details
- The upload validation is implemented on the client; by removing those checks, an attacker can upload executable HTML instead of a safe document.
- Viewing the uploaded file triggers script execution that sends the viewer’s session details to an external server, after which the attacker reuses the cookie to impersonate the admin.

---

### Impact
This is an **unrestricted/insufficiently verified file upload** that results in **stored XSS and session hijacking**. Any user able to upload via the reimbursement workflow can compromise high-privilege accounts that view the uploaded file.

---

## References
- [Horilla Official Website] - (https://www.horilla.com/)  
- [Horilla GitHub Repository] - (https://github.com/horilla-opensource/horilla)  
- [Security Advisory] - (https://github.com/horilla-opensource/horilla/security/advisories/GHSA-mff9-p8j9-9v5q) 
- [Patched Version 1.4.0] - (https://github.com/horilla-opensource/horilla/releases/tag/1.4.0)
